<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <title>日志详情</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/swiper-3.4.2.min.css">
    <!--需要修改引入对应的css-->
    <link rel="stylesheet" href="../css/logDetails.css">
    <link rel="stylesheet" href="../css/mescroll.min.css">
    <!--需要修改引入对应的css-->
</head>
<body id="body">
    <div class="logDetWrapper">
        <div class="bookUserWrap">
            <div class="bookUser clearfix">
                <div class="bookWrap">
                    <div class="userImg">
                        <img src="../images/bookUserImg.png" alt="">
                    </div>
                    <div class="userName">
                        <p class="name">遇见你眼光正好</p>
                        <p class="date">2017-08-24</p>
                    </div>
                </div>
                <div class="follow">
                <span class="followImg">
                    <img src="../images/btn_one_n@2x.png" alt="">
                </span>
                    <span class="fllowTest">关注</span>
                </div>
            </div>
            <div class="logHeadWrap">
                <dvi class="logHead">
                    <img src="../images/icon_rizhiben@2x.png" alt="">
                    查看所属日志本
                </dvi>
                <img src="../images/btn_right_jump@2x.png" alt="" class="btn-right">
            </div>
        </div>
        <!--相关商品-->
        <div class="relatedPro">
            <div class="relatedProHead">
                <img src="../images/icon_xiangguanshangpin@2x.png" alt="">
                相关商品
            </div>
            <div class="productMsg">
                <div class="productImg">
                    <img src="../images/productImg.png" alt="">
                </div>
                <div class="productText">
                    <p class="msg">泰妍雅集美白祛痘保湿补水祛斑+送 价值3960元半永久纹眉+瘦脸瘦身...</p>
                    <p class="buyNumber">
                        已有 <span>368</span>人购买
                    </p>
                </div>
                <div class="goSee">
                    去看看
                </div>
            </div>
        </div>
        <!--护理日志-->
        <div class="nurseLog">
            <div class="logItem">
                <div class="logHeader">
                    <div class="logNum">护理日志 第<span>1</span>季</div>
                    <div class="logDate">2017-08-24</div>
                </div>
                <p class="sectionOne">
                    不知不觉做完已经152天了，我看有宝宝问我为什么没有更新大腿照，我的天我做的是自体脂肪面填啊不知不觉做完已经152天了，我看有不知不觉做完已经152天了，我看有宝宝问我为什么没有更新大腿照，我的天，我做的是自体脂肪面填啊不知不觉做完已经152天了。
                </p>
                <ul>
                    <li class="nurseLogImg">
                        <img src="../images/nurseLogImg.png" alt="">
                    </li>
                </ul>
            </div>
        </div>
        <!--评论-->
        <div class="comment">
            <p class="commentHead">
                评论 (3)
                <span>
                        <i class="new active" i="0">最新</i>
                        <i class="hot" i="1">最热</i>
                    </span>
            </p>

            <ul class="comList" id="dataList">
                <!--  <li>
                      <div class="comItem">
                          <div class="userListHeader">
                              <div class="userHeader clearfix">
                                  <div class="userImg">
                                      <img src="../images/customer02.png" alt="">
                                  </div>
                                  <p class="like">
                                      <img src="../images/icon_Give_the_thumbs_up_n@2x.png" alt="">
                                      <i>213</i>
                                  </p>
                                  <p class="userMessage">Bridge<img src="../images/icon_grade-level@2x.png" alt=""><span class="levelNum">2</span></p>
                                  <p class="userText">2017-08-25  18:20</p>
                              </div>
                          </div>
                          <p class="comContent">
                              老子吃火锅你吃火锅底料,对你笑呵呵,因为我讲礼貌狠货有好多,个人拿去比较,包包头摸摸这个月才几号。
                          </p>
                          <div class="replyStyle">
                              <ul class="replyList" style="display: none">
                                  <li class="replyItem">
                                      <span class="userName">妹妹<i>：</i></span>为保长城不倒，烈马长枪握好，眼看时间不早，对的起江东父老。
                                  </li>
                                  <ul class="replyList" style="display: block">
                                      <li class="replyItem">
                                          <span class="userName"><span>姐姐</span><i class="return">回复</i><span>妹妹</span><i>：</i></span>一往无前虎山行，拨开云雾见光明，梦里花开牡丹亭，幻想成真歌舞升平。
                                      </li>
                                  </ul>
                              </ul>
                          </div>
                          <div class="lookforAllReply" style="display: block">
                              查看全部回复
                              <img src="../images/rightTwo.png" alt="">
                          </div>
                      </div>
                  </li>-->
            </ul>

        </div>
        <!--footer-->
        <footer>
            <input type="text" placeholder="写的好卖力，且评且珍惜">
            <div class="collect">
                <img src="../images/icon_shoucang_n@2x.png" alt="">
                <i>收藏</i>
            </div>
            <div class="like">
                <img src="../images/icon_Give_the_thumbs_up_n@2x.png" alt="">
                <i>200</i>
            </div>
        </footer>
        <!--回到顶部-->
        <div class="goTop">
            <img src="../images/btn_Back_to_the_top@2x.png" alt="">
        </div>
    </div>

<script type="text/javascript" src="../js/rem.js"></script>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/swiper-3.4.2.jquery.min.js"></script>
<script type="text/javascript" src="../js/mescroll.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        /****************************************************************************/
        /*配置mescroll对象*/
        var mescroll = new MeScroll("body", {
            down:{
                use:false,
                auto: true,
                callback: function(mescroll) {
                    //下拉刷新的回调,默认重置上拉加载列表为第一页
                    mescroll.resetUpScroll();
                },
            },
            //上拉加载的配置项
            up: {
                use: true,
                callback: getListData, //上拉回调,此处可简写; 相当于 callback: function (page) { getListData(page); }
                noMoreSize: 4, //如果列表已无数据,可设置列表的总数量要大于半页才显示无更多数据;避免列表数据过少(比如只有一条数据),显示无更多数据会不好看; 默认5
                empty: {
                    icon: "", //图标,默认null
                    tip: "", //提示
                    btntext: "", //按钮,默认""
                    /* btnClick: function(){//点击按钮的回调,默认null
                     /!* alert("点击了按钮,具体逻辑自行实现");*!/
                     }*/
                },
                clearEmptyId: "dataList", //相当于同时设置了clearId和empty.warpId; 简化写法;默认null
                toTop:{ //配置回到顶部按钮
//                    src : "../res/img/mescroll-totop.png", //默认滚动到1000px显示,可配置offset修改
                    //offset : 1000
                },
                page: {
                    num: 0, //当前页 默认0,回调之前会加1; 即callback(page)会从1开始
                    size: 10, //每页数据条数
                    time: null //加载第一页数据服务器返回的时间; 防止用户翻页时,后台新增了数据从而导致下一页数据重复;
                },
//                warpClass: "mescroll-upwarp", //容器,装载布局内容,参见mescroll.css
//                htmlLoading: '<p class="upwarp-progress mescroll-rotate"></p><p class="upwarp-tip">哈哈你看我出来不</p>', //上拉加载中的布局

                htmlLoading: '<div class="loadingImg"><img src="../images/刷新1.gif" alt="">每一天美一点～ </div>', //上拉加载中的布局
                htmlNodata: '<p class="upwarp-nodata">好棒，内容都被你看光光了～</p>', //无数据的布局
                scrollbar: {
//                    use: isPC, //默认只在PC端自定义滚动条样式
                    barClass: "mescroll-bar"
                }
            }
        });
        /*初始化菜单*/
        var pdType=0;//全部商品一次排列分别是：0,1,2,3,4,5,6......
        $(".commentHead>span>i").click(function(){
            var i=$(this).attr("i");
            if(pdType!=i) {
                //更改列表条件
                pdType=i;
                $(".commentHead>span>.active").removeClass("active");
                $(this).addClass("active");
                //重置列表数据
                mescroll.resetUpScroll();
            }
        })
        /*联网加载列表数据  page = {num:1, size:10}; num:当前页 从1开始, size:每页数据条数 */
        function getListData(page){
            console.log(page)
            //联网加载数据
            getListDataFromNet(pdType, page.num, page.size, function(curPageData){
                console.log("pdType="+pdType+", page.num="+page.num+", page.size="+page.size+", curPageData.length="+curPageData.length);
                mescroll.endSuccess(curPageData.length);
                console.log(curPageData)
                console.log(page)

                //设置列表数据
                setListData(curPageData);
            }, function(){
                //联网失败的回调,隐藏下拉刷新和上拉加载的状态;
                mescroll.endErr();
            });
        }
        /*设置列表数据*/
        function setListData(curPageData){
            console.log(curPageData.length)
            var listDom=document.getElementById("dataList");
            for (var i = 0; i < curPageData.length; i++) {
                var pd=curPageData[i];

                var str =' <div class="comItem">' +
                        '<div class="userListHeader">' +
                        '<div class="userHeader clearfix"> ' +
                        '<div class="userImg"><img src="../images/customer02.png" alt=""></div> ' +
                        '<p class="like"><img src="../images/icon_Give_the_thumbs_up_n@2x.png" alt=""><i>213</i></p> ' +
                        '<p class="userMessage">Bridge<img src="../images/icon_grade-level@2x.png" alt=""> <span class="levelNum">2</span></p> ' +
                        '<p class="userText">2017-08-25  18:20</p> ' +
                        '</div>' +
                        '</div> ' +
                        '<p class="comContent">老子吃火锅你吃火锅底料,对你笑呵呵,因为我讲礼貌狠货有好多,个人拿去比较,包包头摸摸这个月才几号。</p> ' +
                        '<div class="replyStyle">' +
                        '<ul class="replyList" style="display: ">' +
                        '<li class="replyItem">' +
                        '<span class="userName">妹妹<i>：</i></span>为保长城不倒，烈马长枪握好，眼看时间不早，对的起江东父老。' +
                        '</li>' +
                        '<ul class="replyList" style="display: block">' +
                        '<li class="replyItem">' +
                        '<span class="userName"><span>姐姐</span><i class="return">回复</i><span>妹妹</span><i>：</i></span>一往无前虎山行，拨开云雾见光明，梦里花开牡丹亭，幻想成真歌舞升平。 ' +
                        '</li>' +
                        '</ul>' +
                        '</ul>' +
                        '</div> ' +
                        '<div class="lookforAllReply" style="display: block">查看全部回复<img src="../images/rightTwo.png" alt=""></div> ' +
                        '</div>';
                var liDom=document.createElement("li");
                liDom.innerHTML=str;
                listDom.appendChild(liDom);

            }
        }
        /*联网加载列表数据*/
        function getListDataFromNet(pdType,pageNum,pageSize,successCallback,errorCallback) {
            //延时一秒,模拟联网
            setTimeout(function () {
                $.ajax({
                    type: 'GET',
                    url: '../json/pdlist1.json',
                    dataType: 'json',
                    success: function(data){
//                        console.log(data)
//                        alert(data.msg)
                        var listData=[];
                        //pdType 全部商品0; 奶粉1; 面膜2; 图书3;
                        if(pdType==0){
                            //全部商品 (模拟分页数据)
//                            console.log(pageNum,pageSize,data.data.list.length)
                            for (var i = (pageNum-1)*pageSize; i < pageNum*pageSize; i++) {
                                if(i==data.length) break;
                                listData.push(data[i]);
                            }
                        }else if(pdType==1){
                            //奶粉
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pdName.indexOf("奶粉")!=-1) {
                                    listData.push(data[i]);
                                }
                            }
                        }else if(pdType==2){
                            //面膜
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pdName.indexOf("面膜")!=-1) {
                                    listData.push(data[i]);
                                }
                            }
                        }else if(pdType==3){
                            //图书
                            for (var i = 0; i < data.length; i++) {
                                if (data[i].pdName.indexOf("图书")!=-1) {
                                    listData.push(data[i]);
                                }
                            }
                        }
                        //回调
                        successCallback(listData);

                    },
                    error: errorCallback
                });
            },1000)
        }
        /****************************************************************************/
        /*评论列表最新、最热切换*/
       /* navSwitch()
        function navSwitch() {
            $('.commentHead>span>i:first-child').addClass('active')
            $('.commentHead>span>i').click(function () {
                $(this).siblings().removeClass('active')
                $(this).addClass('active')
            })
        }*/
        like()
        //点赞
        function like() {
            $('#dataList').on('click','.like>img',function () {
//                    alert('hello')
                if($(this).next().hasClass('active')){
                    return
                }
                $(this).attr({src:'../images/icon_Give_the_thumbs_up@2x.png'}).next().text(parseInt($(this).next().text())+1)
                $(this).next().addClass('active')

            })
        }
        goTop()
        function goTop() {
            $('.goTop').click(function () {
                /*无动画效果*/
//                $(document).scrollTop(0);
                /*有动画效果(根据需求设置)*/
                $('html,body').animate({scrollTop: '0px'}, 800);
            })
        }


    })
</script>
</body>
</html>